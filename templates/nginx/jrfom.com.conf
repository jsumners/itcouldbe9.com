server {
  listen 10.0.0.5:80;
  server_name roomfullofmirrors.com james.roomfullofmirrors.com jrfom.com;

  location ~ "^/\.well-known/acme-challenge/([-_a-zA-Z0-9]+)$" {
    default_type text/plain;
    return 200 "$1.{{ acme_thumbprint }}";
  }

  location ~* ^/2010/03/06/welcome-to-the-new-room-full-of-mirrors(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/03/28/a-package-management-comparison(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/04/07/living-a-little(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/04/08/five-free-os-x-applications(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/05/03/4kb-sectors(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/06/06/day-3-ipad-review(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/06/08/posting-to-notifo-with-python(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/06/16/objective-c-dot-notation(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/06/28/announcing-pwptemplate(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/10/12/a-list-of-things-i-do-and-want-to-do(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/10/29/dont-name-anchor-elements(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/12/10/javascript-cookie-manager-object(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2010/12/23/javascript-patterns-a-book-review(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/01/15/this-ones-for-the-robots(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/01/26/pljson-library(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/02/01/new-swan-login(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/03/25/a-new-song-rule-of-three(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/05/17/a-netcat-tip(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/06/28/ssh-users-ip-address(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/07/13/sonar-2011-remix-competition-and-my-re-emerging-hobby(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/09/28/sshconfig(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/11/04/create-a-daemon-out-of-any-program(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2011/12/08/expected-identifier-string-or-number(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/02/01/oracle-daylight-saving-time-and-unix-timestamps(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/02/10/oracle-and-unix-timestamps-revisited(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/04/06/a-simple-grails-plugin(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/04/17/returning-a-clob-from-a-java-stored-procedure(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/05/09/prolonging-an-ssds-life-by-mitigating-writes(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/05/23/winln-a-windows-symbolic-link-manager(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2012/06/18/346(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/01/23/javascript-via-java-on-the-back-of-a-rhino(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/02/05/cacheviewer-continued-a-history-and-status-update(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/03/21/a-note-on-java-culture-and-a-restlet-tutorial(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/08/20/cacheviewer-continued-is-discontinued(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/08/22/null-is-a-vile-beast(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2013/09/11/the-b-ep(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/01/08/fu-ojdbc(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/08/11/buddypress-and-lighttpd(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/10/13/haproxy-with-keepalived-for-fail-over(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/10/19/dysthymia(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/11/11/veterans-day(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2014/12/27/inversion-of-control-dependency-injection-with-node-js(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2015/01/13/java-8s-lambda-expressions(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2015/02/02/guild-wars-2-and-magic-find(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }
  location ~* ^/2015/02/27/the-internet-isps-and-net-neutrality(.*)? {
    return 301 $scheme://$host/2015archive$request_uri;
  }

  # Fix Wordpress content links
  location ~* "^/wp-content/(.*)/(.*)(-\d{2,3}x\d{2,3})(\.\w{3})$" {
    return 301 $scheme://$host/2015archive/wp-content/uploads/$2$4;
  }

  # for prior site that redirected 'article?id=123' to '/123'
  location ~* ^/(\d+)$ {
    return 301 $scheme://$host/2010archive$request_uri;
  }

  # make sure the 2010 archive still has valid URIs
  location ~* ^/2010archive/comments.php {
    if ($arg_article) {
      return 301 $scheme://$host/2010archive/$arg_article;
    }
    return 301 $scheme://$host/2010archive/;
  }
  location ~* ^/2010archive/(\d+)/(images|files)/(.*) {
    return 301 $scheme://$host/2010archive/$2/$3;
  }

  location / {
    root /var/www/jrfom.com;
    index index.html index.htm;
  }
}
